{"ast":null,"code":"var _jsxFileName = \"/Users/boss/Downloads/fund-raising-updated/fund-raising-ui/src/contexts/AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { jwtDecode } from \"jwt-decode\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport api from \"../utils/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n  const [user, setUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const login = (token, user) => {\n    localStorage.setItem(\"token\", token);\n    setToken(token);\n    setUser(user);\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    setToken(null);\n    setUser(null);\n  };\n  const updateUser = userData => {\n    setUser(userData);\n  };\n  const isAuthenticated = () => {\n    return token !== null && token !== undefined;\n  };\n  const isAdmin = () => {\n    return isAuthenticated() && (user === null || user === void 0 ? void 0 : user.role) === \"ROLE_ADMIN\";\n  };\n  const isUser = () => {\n    return isAuthenticated() && (user === null || user === void 0 ? void 0 : user.role) === \"ROLE_USER\";\n  };\n  const isDonor = () => {\n    return isAuthenticated() && (user === null || user === void 0 ? void 0 : user.role) === \"ROLE_DONOR\";\n  };\n  const getUser = async (userId, role) => {\n    const urlMap = {\n      ROLE_ADMIN: `/admins/${userId}`,\n      ROLE_USER: `/users/${userId}`,\n      ROLE_DONOR: `/donors/${userId}`\n    };\n    try {\n      const response = await api.get(urlMap[role]);\n      const user = response.data;\n      const userDetails = {\n        ...user,\n        userId: role === \"ROLE_ADMIN\" ? user.id : role === \"ROLE_USER\" ? user.id : role === \"ROLE_DONOR\" ? user.id : null\n      };\n      return userDetails;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const setUserDetails = userDetails => {\n    setUser(userDetails);\n  };\n  useEffect(() => {\n    const onLoad = async () => {\n      if (isAuthenticated()) {\n        setIsLoading(true);\n        const decodedToken = jwtDecode(token || localStorage.getItem(\"token\"));\n        const user = await getUser(decodedToken === null || decodedToken === void 0 ? void 0 : decodedToken.userId, decodedToken === null || decodedToken === void 0 ? void 0 : decodedToken.role);\n        setUser({\n          ...user,\n          role: decodedToken === null || decodedToken === void 0 ? void 0 : decodedToken.role\n        });\n        setIsLoading(false);\n      } else {\n        setIsLoading(false);\n      }\n    };\n    onLoad();\n    // eslint-disable-next-line\n  }, [token]);\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token,\n      user,\n      login,\n      logout,\n      updateUser,\n      isAuthenticated,\n      isAdmin,\n      isUser,\n      isDonor,\n      setUser: setUserDetails\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"s8rR/mmz5uPPebBdCIM/hEZIua0=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["jwtDecode","React","createContext","useContext","useEffect","useState","api","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","token","setToken","localStorage","getItem","user","setUser","isLoading","setIsLoading","login","setItem","logout","removeItem","updateUser","userData","isAuthenticated","undefined","isAdmin","role","isUser","isDonor","getUser","userId","urlMap","ROLE_ADMIN","ROLE_USER","ROLE_DONOR","response","get","data","userDetails","id","error","console","log","setUserDetails","onLoad","decodedToken","fileName","_jsxFileName","lineNumber","columnNumber","Provider","value","_c","$RefreshReg$"],"sources":["/Users/boss/Downloads/fund-raising-updated/fund-raising-ui/src/contexts/AuthContext.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\nimport React, { createContext, useContext, useEffect, useState } from \"react\";\nimport api from \"../utils/api\";\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport const AuthProvider = ({ children }) => {\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n  const [user, setUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const login = (token, user) => {\n    localStorage.setItem(\"token\", token);\n    setToken(token);\n    setUser(user);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    setToken(null);\n    setUser(null);\n  };\n\n  const updateUser = (userData) => {\n    setUser(userData);\n  };\n\n  const isAuthenticated = () => {\n    return token !== null && token !== undefined;\n  };\n\n  const isAdmin = () => {\n    return isAuthenticated() && user?.role === \"ROLE_ADMIN\";\n  };\n\n  const isUser = () => {\n    return isAuthenticated() && user?.role === \"ROLE_USER\";\n  };\n\n  const isDonor = () => {\n    return isAuthenticated() && user?.role === \"ROLE_DONOR\";\n  };\n\n  const getUser = async (userId, role) => {\n    const urlMap = {\n      ROLE_ADMIN: `/admins/${userId}`,\n      ROLE_USER: `/users/${userId}`,\n      ROLE_DONOR: `/donors/${userId}`,\n    };\n    try {\n      const response = await api.get(urlMap[role]);\n      const user = response.data;\n      const userDetails = {\n        ...user,\n        userId:\n          role === \"ROLE_ADMIN\"\n            ? user.id\n            : role === \"ROLE_USER\"\n            ? user.id\n            : role === \"ROLE_DONOR\"\n            ? user.id\n            : null,\n      };\n      return userDetails;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const setUserDetails = (userDetails) => {\n    setUser(userDetails);\n  };\n\n  useEffect(() => {\n    const onLoad = async () => {\n      if (isAuthenticated()) {\n        setIsLoading(true);\n        const decodedToken = jwtDecode(token || localStorage.getItem(\"token\"));\n        const user = await getUser(decodedToken?.userId, decodedToken?.role);\n        setUser({ ...user, role: decodedToken?.role });\n        setIsLoading(false);\n      } else {\n        setIsLoading(false);\n      }\n    };\n    onLoad();\n    // eslint-disable-next-line\n  }, [token]);\n\n  if (isLoading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        token,\n        user,\n        login,\n        logout,\n        updateUser,\n        isAuthenticated,\n        isAdmin,\n        isUser,\n        isDonor,\n        setUser: setUserDetails,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}